pipeline {

    agent { label "scarf" }

    triggers {
        cron("* * * * 1")
    }

    stages {

        stage("Benchmark"){
            checkout scm
            sh """
                cd tests_and_analysis/performance_benchmarking &&
                sbatch run_benchmark_tests.sbatch
            """
        }

    }

    post {
        always {
            junit 'reports/junit_report*.xml'
        }

        success {
            setGitHubBuildStatus("success", "Successful", "Performance")
        }

        unsuccessful {
            setGitHubBuildStatus("failure", "Unsuccessful", "Performance")
        }

        cleanup {
            deleteDir()
        }
    }
}